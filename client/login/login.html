<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cathago Login Form</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap");

      :root {
        --primary-color: #4a7fff;
        --primary-dark: #3a63cc;
        --background: #121212;
        --card-bg: #1e1e1e;
        --text-primary: #ffffff;
        --text-secondary: #b0b0b0;
        --input-bg: #2a2a2a;
        --input-border: #3a3a3a;
        --input-focus: #4a7fff;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #121212 0%, #1a1a1a 100%);
        color: var(--text-primary);
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        overflow-x: hidden;
        position: relative;
      }

      body::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(
          circle at 50% 50%,
          rgba(74, 127, 255, 0.1),
          transparent 60%
        );
        z-index: 0;
      }

      .login-container {
        background-color: var(--card-bg);
        border-radius: 16px;
        padding: 40px;
        width: 400px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        position: relative;
        z-index: 1;
        backdrop-filter: blur(5px);
        border: 1px solid rgba(255, 255, 255, 0.05);
        transform: translateY(20px);
        opacity: 0;
        animation: fadeIn 0.8s ease-out forwards;
      }

      @keyframes fadeIn {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .logo {
        text-align: center;
        margin-bottom: 30px;
      }

      .logo svg {
        height: 40px;
        fill: var(--primary-color);
      }

      .login-container h2 {
        text-align: center;
        margin-bottom: 30px;
        color: var(--text-primary);
        font-weight: 600;
        font-size: 24px;
        letter-spacing: 0.5px;
        position: relative;
        display: inline-block;
        left: 50%;
        transform: translateX(-50%);
      }

      .login-container h2::after {
        content: "";
        position: absolute;
        height: 3px;
        width: 40px;
        background: var(--primary-color);
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        border-radius: 3px;
      }

      .form-group {
        margin-bottom: 24px;
        position: relative;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-size: 14px;
        color: var(--text-secondary);
        font-weight: 500;
        transition: all 0.3s ease;
      }

      .form-group input {
        width: 100%;
        padding: 14px 16px;
        border: 1px solid var(--input-border);
        border-radius: 8px;
        background-color: var(--input-bg);
        color: var(--text-primary);
        font-size: 14px;
        transition: all 0.3s ease;
        font-family: "Poppins", sans-serif;
      }

      .form-group input:focus {
        border-color: var(--input-focus);
        outline: none;
        box-shadow: 0 0 0 3px rgba(74, 127, 255, 0.15);
      }

      .form-group input::placeholder {
        color: var(--text-secondary);
        opacity: 0.7;
      }

      .login-btn {
        width: 100%;
        padding: 14px;
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        font-size: 16px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        font-family: "Poppins", sans-serif;
        letter-spacing: 0.5px;
        margin-top: 10px;
      }

      .login-btn:hover {
        background-color: var(--primary-dark);
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(74, 127, 255, 0.25);
      }

      .login-btn:active {
        transform: translateY(0);
      }

      .login-btn::after {
        content: "";
        position: absolute;
        width: 30px;
        height: 200px;
        background-color: rgba(255, 255, 255, 0.2);
        top: -50px;
        left: -100px;
        transform: rotate(45deg);
        transition: all 0.5s;
      }

      .login-btn:hover::after {
        left: 120%;
      }

      .register-link {
        text-align: center;
        margin-top: 25px;
        font-size: 14px;
        color: var(--text-secondary);
      }

      .register-link a {
        color: var(--primary-color);
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
      }

      .register-link a:hover {
        text-decoration: underline;
      }

      .password-toggle {
        position: absolute;
        right: 15px;
        top: 15px;
        color: var(--text-secondary);
        cursor: pointer;
        transition: all 0.3s ease;
        z-index: 2;
      }

      .password-toggle:hover {
        color: var(--primary-color);
      }

      .input-group {
        position: relative;
      }

      .error-message {
        color: #ff5252;
        font-size: 12px;
        margin-top: 5px;
        display: none;
      }

      .animated-background {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        opacity: 0.4;
      }

      .circle {
        position: absolute;
        border-radius: 50%;
        background: var(--primary-color);
        animation: float 8s infinite;
        opacity: 0.1;
      }

      .circle:nth-child(1) {
        width: 300px;
        height: 300px;
        top: -150px;
        left: -150px;
        animation-delay: -1s;
      }

      .circle:nth-child(2) {
        width: 200px;
        height: 200px;
        top: 50%;
        right: -100px;
        animation-delay: -2.5s;
      }

      .circle:nth-child(3) {
        width: 150px;
        height: 150px;
        bottom: -75px;
        left: 20%;
        animation-delay: -4s;
      }

      .forgot-password {
        text-align: right;
        margin-top: -15px;
        margin-bottom: 20px;
      }

      .forgot-password a {
        color: var(--primary-color);
        font-size: 13px;
        text-decoration: none;
        transition: all 0.3s ease;
      }

      .forgot-password a:hover {
        text-decoration: underline;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0) translateX(0);
        }
        25% {
          transform: translateY(-20px) translateX(10px);
        }
        50% {
          transform: translateY(0) translateX(20px);
        }
        75% {
          transform: translateY(20px) translateX(10px);
        }
      }

      /* Message Styles */
      #message {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        z-index: 1000;
        opacity: 0;
        animation: messageAppear 0.3s forwards;
      }

      @keyframes messageAppear {
        to {
          opacity: 1;
          transform: translateX(-50%) translateY(0);
        }
      }

      #message.error {
        background-color: rgba(255, 82, 82, 0.95);
        color: white;
        box-shadow: 0 4px 12px rgba(255, 82, 82, 0.35);
      }

      #message.success {
        background-color: rgba(76, 217, 100, 0.95);
        color: white;
        box-shadow: 0 4px 12px rgba(76, 217, 100, 0.35);
      }

      @media (max-width: 480px) {
        .login-container {
          width: 90%;
          padding: 30px 20px;
        }
      }

      /* Loading indicator */
      .login-btn.loading {
        position: relative;
        color: transparent;
      }

      .login-btn.loading::before {
        content: "";
        position: absolute;
        width: 20px;
        height: 20px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: white;
        left: calc(50% - 10px);
        top: calc(50% - 10px);
        animation: spinner 0.8s linear infinite;
      }

      @keyframes spinner {
        to {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body>
    <div class="animated-background">
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
    </div>

    <div class="login-container">
      <div class="logo">
        <svg viewBox="0 0 200 50" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M20,25 C20,13.954 28.954,5 40,5 L160,5 C171.046,5 180,13.954 180,25 C180,36.046 171.046,45 160,45 L40,45 C28.954,45 20,36.046 20,25 Z M40,15 C34.477,15 30,19.477 30,25 C30,30.523 34.477,35 40,35 C45.523,35 50,30.523 50,25 C50,19.477 45.523,15 40,15 Z M70,15 L70,35 L85,35 L85,30 L75,30 L75,15 L70,15 Z M90,15 L90,35 L105,35 L105,30 L95,30 L95,27.5 L103,27.5 L103,22.5 L95,22.5 L95,20 L105,20 L105,15 L90,15 Z M110,15 L110,35 L125,35 L125,30 L115,30 L115,15 L110,15 Z M130,15 L130,35 L145,35 L145,30 L135,30 L135,27.5 L143,27.5 L143,22.5 L135,22.5 L135,20 L145,20 L145,15 L130,15 Z M150,15 L150,35 L165,35 L165,30 L155,30 L155,15 L150,15 Z"
          />
        </svg>
      </div>
      <h2>Welcome Back</h2>
      <form id="loginForm">
        <div class="form-group">
          <label for="username">Username</label>
          <input
            type="text"
            id="username"
            placeholder="Enter your username"
            required
          />
          <div class="error-message" id="username-error"></div>
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <div class="input-group">
            <input
              type="password"
              id="password"
              placeholder="Enter your password"
              required
            />
            <span class="password-toggle" id="togglePassword">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
            </span>
          </div>
          <div class="error-message" id="password-error"></div>
        </div>

        <div class="forgot-password">
          <a href="#">Forgot password?</a>
        </div>

        <button type="submit" class="login-btn">Sign In</button>
      </form>
      <div class="register-link">
        <span>Don't have an account?</span>
        <a href="../registration/registration.html">Register now</a>
      </div>
    </div>

    <script>
      // Check if already logged in
      if (localStorage.getItem("token")) {
        window.location.href = "../dashboard/dashboard.html";
      }

      // Toggle password visibility
      document
        .getElementById("togglePassword")
        .addEventListener("click", function () {
          const passwordInput = document.getElementById("password");
          if (passwordInput.type === "password") {
            passwordInput.type = "text";
            this.innerHTML = `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
          <line x1="1" y1="1" x2="23" y2="23"></line>
        </svg>`;
          } else {
            passwordInput.type = "password";
            this.innerHTML = `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
          <circle cx="12" cy="12" r="3"></circle>
        </svg>`;
          }
        });

      // API login integration
      document
        .getElementById("loginForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const username = document.getElementById("username").value;
          const password = document.getElementById("password").value;

          // Validate input
          if (!username || !password) {
            showMessage("Please fill in all fields", "error");
            return;
          }

          // Show loading state
          const button = document.querySelector(".login-btn");
          button.classList.add("loading");
          button.disabled = true;

          // Create login object
          const loginData = {
            username,
            password,
          };

          try {
            // Make API call
            const response = await fetch("http://localhost:3000/auth/login", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(loginData),
            });

            const data = await response.json();
            console.log("API response:", data);

            // Remove loading state
            button.classList.remove("loading");
            button.disabled = false;

            if (response.ok) {
              localStorage.setItem("username", data.username);
              localStorage.setItem("role", data.role);
              localStorage.setItem("token", data.token);

              showMessage(
                `User ${username} logged in successfully!`,
                "success"
              );
              this.reset();
              setTimeout(() => {
                window.location.href = "../dashboard/dashboard.html";
              }, 3000);
            } else {
              showMessage(`Error: ${data.message}`, "error");
            }
          } catch (error) {
            console.error("Error logging in user:", error);
            showMessage("An error occurred. Please try again.", "error");

            // Remove loading state in case of error
            button.classList.remove("loading");
            button.disabled = false;
          }
        });

      function showMessage(text, type) {
        let messageDiv = document.getElementById("message");
        if (!messageDiv) {
          messageDiv = document.createElement("div");
          messageDiv.id = "message";
          document.body.appendChild(messageDiv);
        }
        messageDiv.textContent = text;
        messageDiv.className = type;

        // Clear message after 3 seconds
        setTimeout(() => {
          messageDiv.textContent = "";
          messageDiv.className = "";
        }, 3000);
      }

      // Add subtle animation to form elements on page load
      document.addEventListener("DOMContentLoaded", function () {
        const formGroups = document.querySelectorAll(
          ".form-group, .forgot-password, .login-btn"
        );
        formGroups.forEach((group, index) => {
          group.style.opacity = "0";
          group.style.transform = "translateY(20px)";
          setTimeout(() => {
            group.style.transition = "all 0.5s ease";
            group.style.opacity = "1";
            group.style.transform = "translateY(0)";
          }, 100 + index * 100);
        });
      });
    </script>
  </body>
</html>
